<!DOCTYPE html>
<html lang="en">

    <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>WeatherPro - Advanced Weather App</title>
        <meta name="theme-color" content="#0f2027" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
        <link rel="manifest" href="manifest.json" />
</head>

<body>
    <header>
        <div class="brand">
            <i class="fas fa-cloud-sun fa-lg"></i>
            <h1>WeatherPro</h1>
        </div>
        <nav>
            <a href="#current" aria-label="Go to Current Weather section">Current</a>
            <a href="#forecast" aria-label="Go to Forecast section">Forecast</a>
            <a href="#about" aria-label="Go to About section">About</a>
        </nav>
        <div class="settings-toggles">
            <div class="unit-toggle" id="unitToggleContainer">
                <span class="unit-label">°C</span>
                <label class="switch" aria-label="Toggle temperature unit between Celsius and Fahrenheit">
                    <input type="checkbox" id="unitToggle" />
                    <span class="slider"></span>
                </label>
                <span class="unit-label">°F</span>
            </div>
            <button id="settingsBtn" class="neumorphic" aria-haspopup="dialog" aria-controls="settingsModal" title="Open settings"><i class="fas fa-gear"></i></button>
        </div>
    </header>

    <main>
        <section id="alertsBanner" class="alerts-banner" aria-live="polite" aria-atomic="true" style="display:none;"></section>
        <section id="savedLocations" class="saved-locations-section" aria-label="Saved locations"></section>

        <section class="search-section" aria-label="Search for weather">
            <input type="text" id="cityInput" placeholder="Enter city name" aria-label="City name input"
                autocomplete="off" />
            <button id="searchBtn" class="neumorphic" aria-label="Get weather for city"
                title="Get weather for entered city">Get Weather</button>
            <button id="locBtn" class="neumorphic" title="Get weather for my current location"
                aria-label="Get weather for current location">
                <i class="fas fa-location-arrow"></i>
            </button>
            <div id="autocompleteList" class="autocomplete-list" role="listbox" aria-label="City suggestions" style="display:none;"></div>
            <button id="shareLinkBtn" class="neumorphic" title="Copy shareable link" aria-label="Copy shareable link"><i class="fas fa-link"></i></button>
        </section>

        <section id="current" class="weather-display neumorphic" tabindex="0" aria-live="polite" aria-atomic="true"
            aria-label="Current weather information"></section>

        <!-- Hindi Panchang (Tithi / Month / Year) -->
        <section id="panchang-section" class="neumorphic" aria-label="Hindi Panchang">
            <h2>हिन्दी पंचांग</h2>
            <div id="panchangContent" class="panchang-grid" aria-live="polite"></div>
        </section>

        <!-- Hourly forecast cards -->
        <section id="hourly-forecast" class="hourly-forecast-display">
            <h2>Hourly Forecast</h2>
            <div class="hourly-tabs" id="hourlyTabs" role="tablist" aria-label="Select day for hourly forecast"></div>
            <div class="hourly-container" id="hourlyContainer"></div>
            <div class="hourly-sparkline"><canvas id="hourlySparkline" height="80"></canvas></div>
        </section>

        <!-- Daily forecast cards -->
        <section id="forecast" class="forecast-display">
            <h2>Daily Forecast</h2>
            <div class="forecast-container" id="forecastContainer"></div>
            <div class="forecast-actions">
                <button id="moreDaysBtn" class="neumorphic" aria-label="Load extended forecast">More days</button>
            </div>
        </section>

        <!-- Weather History & Trends -->
        <section id="history" class="neumorphic" aria-label="Weather history for past 7 days" style="padding:14px;">
            <h2>Weather History (7 days)</h2>
            <canvas id="historyChart" height="220"></canvas>
            <div id="historyError" style="display:none; color: var(--danger); text-align:center; margin-top:8px;"></div>
            <div class="history-actions">
                <button id="compareToggleBtn" class="neumorphic" aria-expanded="false">Compare cities</button>
                <div id="comparePanel" class="compare-panel" style="display:none;">
                    <div id="compareCitiesList" class="compare-cities-list" aria-label="Select cities to compare"></div>
                    <button id="applyCompareBtn" class="neumorphic">Apply</button>
                </div>
                <button id="exportCsvBtn" class="neumorphic">Export CSV</button>
                <button id="shareImageBtn" class="neumorphic">Share image</button>
                <span id="staleBadge" class="stale-badge" style="display:none;" title="Showing cached data">Stale</span>
            </div>
        </section>

        <section id="lifestyle-section" class="lifestyle-container">
            <div id="activities-section" class="neumorphic">
                <h2>Activities</h2>
                <div class="activities-grid"></div>
            </div>
            <div id="allergies-section" class="neumorphic">
                <h2>Allergies</h2>
                <div class="allergies-grid"></div>
            </div>
            <div id="suggestions-section" class="neumorphic">
                <h2>Suggestions</h2>
                <div id="suggestionsList"></div>
            </div>
        </section>

        <section id="map-section" class="map-container neumorphic">
            <h2>Live Weather Map</h2>
            <div class="map-controls">
                <button class="map-btn neumorphic active" data-layer="rain">Radar</button>
                <button class="map-btn neumorphic" data-layer="clouds">Clouds</button>
                <button class="map-btn neumorphic" data-layer="temp">Temperature</button>
                <label class="opacity-label">Opacity <input type="range" id="layerOpacity" min="0" max="1" step="0.05" value="0.7" /></label>
                <div class="map-search">
                    <input type="text" id="mapSearchInput" placeholder="Search on map" aria-label="Map search" />
                    <button id="mapSearchBtn" class="neumorphic" aria-label="Search on map"><i class="fas fa-search"></i></button>
                </div>
            </div>
            <div id="windy-map"></div>
            <div id="mapLegend" class="map-legend" aria-live="polite"></div>
        </section>

        <section id="about" class="about-section neumorphic" tabindex="0">
            <h2>About WeatherPro</h2>
            <p>
                WeatherPro is your professional weather assistant, designed for accuracy, accessibility, and style.
                Built using modern web technologies, it provides real-time data, forecasts, activity ratings, and a
                live, interactive weather map from Windy.com.
            </p>
            <ul>
                <li><i class="fas fa-check-circle"></i> Real-time data with hourly updates</li>
                <li><i class="fas fa-check-circle"></i> Unit conversion (Celsius/Fahrenheit)</li>
                <li><i class="fas fa-check-circle"></i> Advanced interactive weather map</li>
                <li><i class="fas fa-check-circle"></i> Accessible and responsive Neumorphic UI</li>
            </ul>
        </section>
    </main>

    <footer class="neumorphic">
        <nav class="footer-nav" aria-label="Footer navigation">
            <a href="#current">Current</a>
            <a href="#forecast">Forecast</a>
            <a href="#about">About</a>
        </nav>
        <div class="footer-contact" aria-label="Contact information">
            <p>Contact us: <a href="mailto:info@weatherpro.com">info@weatherpro.com</a> | +1 555 1234</p>
        </div>
        <p>&copy; 2025 WeatherPro. All rights reserved.</p>
    </footer>

    <div class="loader" id="loader" aria-live="assertive" aria-label="Loading indicator"></div>

    <!-- Global weather animations overlay -->
    <div id="weather-anim" aria-hidden="true"></div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="settingsTitle" style="display:none;">
        <div class="modal-content neumorphic">
            <div class="modal-header">
                <h3 id="settingsTitle">Settings</h3>
                <button id="closeSettingsBtn" aria-label="Close settings" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <label for="langSelect">Language</label>
                    <select id="langSelect">
                        <option value="en">English</option>
                        <option value="es">Español</option>
                        <option value="fr">Français</option>
                        <option value="de">Deutsch</option>
                        <option value="hi">हिन्दी</option>
                    </select>
                </div>
                <div class="form-row">
                    <label class="switch-label"><input type="checkbox" id="reduceMotionToggle" /> Reduce motion</label>
                </div>
                <div class="form-row">
                    <strong>Notifications</strong>
                    <label class="switch-label"><input type="checkbox" id="notifyRainToggle" /> Rain soon</label>
                    <label class="switch-label"><input type="checkbox" id="notifyUvToggle" /> High UV</label>
                </div>
                <div class="form-row">
                    <strong>Activity preferences</strong>
                    <label>Comfort temp min <input type="number" id="prefTempMin" value="10" /></label>
                    <label>Comfort temp max <input type="number" id="prefTempMax" value="30" /></label>
                    <label>Max wind (kph) <input type="number" id="prefMaxWind" value="25" /></label>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveSettingsBtn" class="neumorphic">Save</button>
            </div>
        </div>
    </div>

    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""
    />
    <script
        src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""
        defer
    ></script>
    <!-- SunCalc for moon phase/tithi calculations -->
    <script src="https://unpkg.com/suncalc@1.9.0/suncalc.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" defer></script>
    <script src="script.js" defer></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('sw.js').catch(() => {});
        });
      }
    </script>
</body>

</html>